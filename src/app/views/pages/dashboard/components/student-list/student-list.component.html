<div class="student-list">
    <h3 class="title-section">
        لیست دانش آموزان
    </h3>

    <div class="data-all-report">
        <div class="row">
            <div class="title-value">
                <div class="title">
                    مجموع درآمد :
                </div>
                <div class="value">
                    <span class="orange">{{dataDashboard?.totalRevenue| number}}</span>
                    (تومان)
                </div>
            </div>
        </div>
        <div class="row">
            <div class="title-value">
                <div class="title gray">مجموع سهم شما از اقساط پرداخت شده :</div>
                <div class="value">
                    <span>{{dataDashboard?.totalRevenuePaid| number}}</span>
                    (تومان)
                </div>
            </div>
            <div class="title-value">
                <div class="title gray">مجموع سهم شما از اقساط بدهکار :</div>
                <div class="value">
                    <span>{{dataDashboard?.totalRevenueUnPaid| number}}</span>
                    (تومان)
                </div>
            </div>
        </div>
    </div>
    <app-filter-student-dashboard class="filter" [loading]="loadingTable" />
    <div class="total-count">
        تعداد کل : {{totalCount}} مورد
    </div>
    <div class="holder-data">
        <div class="data-table">
            <div class="table-wrapper">
                <table mat-table [dataSource]="tableData" class="table-custom table-dashboard">
                    <!-- row Column -->
                    <ng-container matColumnDef="row">
                        <th mat-header-cell *matHeaderCellDef>
                            <!-- <span class="row-title">ردیف</span> -->
                        </th>
                        @if(pageNumber > 1){
                        <td mat-cell *matCellDef="let element; let i = index">
                            {{ (pageNumber - 1) * pageSize + (i + 1) }}
                        </td>
                        } @else {
                        <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
                        }
                    </ng-container>

                    <!-- name Column -->
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef> نام </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.studentFirstName}}
                        </td>
                    </ng-container>

                    <!-- lastName Column -->
                    <ng-container matColumnDef="lastName">
                        <th mat-header-cell *matHeaderCellDef>نام خانوادگی</th>
                        <td mat-cell *matCellDef="let element">
                            {{element.studentLastName}}
                        </td>
                    </ng-container>

                    <!-- registerDate Column -->
                    <ng-container matColumnDef="registerDate">
                        <th mat-header-cell *matHeaderCellDef>تاریخ ثبت نام</th>
                        <td mat-cell *matCellDef="let element">
                            @if(element.createdDateTime !== null){
                            {{ element.createdDateTime.split("T")[0] | jalali }}
                            } @else{-}
                        </td>
                    </ng-container>

                    <!-- code Column -->
                    <ng-container matColumnDef="code">
                        <th mat-header-cell *matHeaderCellDef> کد </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.discountCode}}
                        </td>
                    </ng-container>

                    <!-- paymentType Column -->
                    <ng-container matColumnDef="paymentType">
                        <th mat-header-cell *matHeaderCellDef> نوع پرداخت </th>
                        <td mat-cell *matCellDef="let element">
                            @switch (element.orderStatus) {
                            @case (orderStatusType.Pending) {در انتظار پرداخت}
                            @case (orderStatusType.Paid) {پرداخت شده}
                            @case (orderStatusType.Faild) {لغو پرداخت}
                            @case (orderStatusType.Canceled) {کنسل شده}
                            @case (orderStatusType.InstallmentsWithInitialPayment) {اقساطی با پرداخت اولیه}
                            }
                        </td>
                    </ng-container>

                    <!-- courses Column -->
                    <ng-container matColumnDef="courses">
                        <th mat-header-cell *matHeaderCellDef> دوره ها </th>
                        <td mat-cell *matCellDef="let element">
                            <a class="link-arrow" (click)="getItemDataCourse(element.orderId)">
                                دوره ها
                                @if(loadingItemRow === element.orderId){
                                <i class="fa-regular fa-spinner fa-spin"></i>
                                }@else {
                                <i class="fa-solid fa-chevron-left"></i>
                                }
                            </a>
                        </td>
                    </ng-container>

                    <!-- installment Column -->
                    <ng-container matColumnDef="installment">
                        <th mat-header-cell *matHeaderCellDef> اقساط پرداختی </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.orderInstallmentPaidCountAndTotalCount}}
                        </td>
                    </ng-container>

                    <!-- identifierName Column -->
                    <ng-container matColumnDef="identifierName">
                        <th mat-header-cell *matHeaderCellDef> نام معرف </th>
                        <td mat-cell *matCellDef="let element">
                            -
                        </td>
                    </ng-container>

                    <!-- agentShareFromDebtInstallments Column -->
                    <ng-container matColumnDef="agentShareFromDebtInstallments">
                        <th mat-header-cell *matHeaderCellDef>
                            <div class="title-value">
                                <span class="title">سهم نماینده</span>
                                <span class="value">از اقساط بدهکار</span>
                            </div>
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.agentShareFromDebtInstallments | number}}
                        </td>
                    </ng-container>

                    <!-- agentShareFromPayments Column -->
                    <ng-container matColumnDef="agentShareFromPayments">
                        <th mat-header-cell *matHeaderCellDef>
                            <div class="title-value">
                                <span class="title">سهم نماینده</span>
                                <span class="value">از پرداختی ها</span>
                            </div>
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.agentShareFromPayments | number}}
                        </td>
                    </ng-container>

                    <!-- agentShareTotal Column -->
                    <ng-container matColumnDef="agentShareTotal">
                        <th mat-header-cell *matHeaderCellDef>
                            <div class="title-value">
                                <span class="title">سهم نماینده</span>
                                <span class="value">مجموع</span>
                            </div>
                        </th>
                        <td mat-cell *matCellDef="let element">
                            {{element.agentShareTotal | number}}
                        </td>
                    </ng-container>



                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                @if(loadingTable){
                <mat-progress-bar mode="query"></mat-progress-bar>
                }
                @if(totalCount
                < 1 && !loadingTable){ <app-empty-list />
                }
            </div>
            <app-pagination-share [pageSize]="pageSize" [pageNumberInput]="pageNumber" [totalCount]="totalCount"
                (pageNumber)="pageNumberSelected($event)" />
        </div>
    </div>
</div>